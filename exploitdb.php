<?php
require_once("databasedetails.php");
require_once("otherfunctions.php");
echo "<!DOCTYPE html>
<!-- saved from url=(0043)http://getbootstrap.com/examples/dashboard/ --><html lang='en'><head><meta http-equiv='Content-Type' content='text/html; charset=UTF-8'><meta http-equiv='X-UA-Compatible' content='IE=edge'><meta name='viewport' content='width=device-width, initial-scale=1'><!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags --><meta name='description' content=''><meta name='author' content=''>
<link rel='icon' href='./Dashboard Template for Bootstrap_files/security.png'>
<title>Exploit kit</title>
    <!-- Bootstrap core CSS -->
    <link href='./Dashboard Template for Bootstrap_files/bootstrap.min.css' rel='stylesheet'>

    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <link href='./Dashboard Template for Bootstrap_files/ie10-viewport-bug-workaround.css' rel='stylesheet'>
  <link rel='stylesheet' type='text/css' href='analytics.css's>
    <!-- Custom styles for this template -->
    <link href='./Dashboard Template for Bootstrap_files/dashboard.css' rel='stylesheet'>

    <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
    <!--[if lt IE 9]><script src='../../assets/js/ie8-responsive-file-warning.js'></script><![endif]-->
    <script src='./Dashboard Template for Bootstrap_files/ie-emulation-modes-warning.js.download'></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src='https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js'></script>
      <script src='https://oss.maxcdn.com/respond/1.4.2/respond.min.js'></script>
    <![endif]-->
  </head>

  <body>

    <nav class='navbar navbar-inverse navbar-fixed-top'>
      <div class='container-fluid'>
        <div class='navbar-header'>
          <button type='button' class='navbar-toggle collapsed' data-toggle='collapse' data-target='#navbar' aria-expanded='false' aria-controls='navbar'>
            <span class='sr-only'>Toggle navigation</span>
            <span class='icon-bar'></span>
            <span class='icon-bar'></span>
            <span class='icon-bar'></span>
          </button>
 <a class='navbar-brand' href='#openModal'>Exploit Kit</a>
 </div>
        <div id='navbar' class='navbar-collapse collapse'>
          <ul class='nav navbar-nav navbar-right'>
            

            <div class='dropdown'>
  <button class='dropbtn' >Clear Statistics</button>
  <div class='dropdown-content'>
    <form method='POST' id='clearform'><input type='hidden' name='clear' value='Yes'><a href='#' class='red' onclick='javascript:document.getElementById(\"clearform\").submit();'>Yes</a><a class='red' href='guiek.php'>No</a></form>

  </div>
</div>
            <li><a href='install.php?go=instoall'>Settings</a></li>
            <li><a href='guiek.php?go=logout'>Logout</a></li>
          </ul>
          
        </div>
      </div>
    </nav>
    
    <div class='container-fluid'>
      <div class='row'>
        <div class='col-sm-3 col-md-2 sidebar'>
          <ul class='nav nav-sidebar'>
            <li><a href='guiek.php'>Dashboard</a></li>
            <li><a href='guiek.php?go=report'>Reports<span class='sr-only'>(current)</span></a></li>
            <li><a href='analytics.php'>Analytics</a></li>
            <li class='active'><a href='exploitdb.php'>Import</a></li>
          </ul>
          
          <ul class='nav nav-sidebar'>
            
            <li><a href='exploitselector.php' target='_blank'>Demo</a></li>
            <li><a href='guiek.php?go=about'>About</a></li>
          </ul>
          <br><br><br><br><br><br><br><br><h5 style='font-family: tahoma;color:#428bca'>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp CODE NAME</h5>
          <h4> &nbsp&nbsp&nbsp&nbsp SHADAYANTRA</h4>
        </div>
<div class='col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main'>
          <h1 class='page-header'> Exploit Database</h1>
<form method='POST' action='exploitdb.php' onSubmit='return onSend()'>
<input name='id' id='idd' type='number' placeholder='Id'/>
<input name='os' id='osname' type='text' placeholder='Platform'/>
<input name='browser' id='browsername' type='text' placeholder='Browser'/>
<input name='browserver' id='browservernum' type='text' placeholder='Browser Version'/>
    <input type='text' name='fileToUpload' id='fileToUpload' placeholder='Exploit Name (.html)'/>
	<input type='submit' name='submit' value='Submit' />
    <input type='submit' name='update' value='Update'/>
</form>


<script>
function onSend()
{
if (document.getElementById('idd').value=='')
	{
		alert('Please fill Id field');
		return false;
	}
if (document.getElementById('osname').value=='')
	{
		alert('Please fill Operating System field');
		return false;
	}
if (document.getElementById('browsername').value=='')
	{
		alert('Please fill Browser name field!');
		return false;
	}
if (document.getElementById('browservernum').value=='')
	{
		alert('Please fill Browser Version field!');
		return false;
	}
else
	{
		return true;
	}

}


 }
</script>


          <h2 class='sub-header'>Overview</h2>
          <div class='table-responsive'>
            <table class='table table-striped'>
              <thead>
                <tr>
  				  <th>ID</th>
                  <th>PLATFORM</th>
                 <th>BROWSER</th>
                  <th>BROWSER VERSION</th>
                  <th>EXPLOIT USED</th>
                
                </tr>
              </thead>
           <div id='openModal' class='modalDialog'>
            <div>
              <div>
              <a href='#close' title='close' class='close'>X</a>
              <h1>Explot Kit-Shadyantra</h1>
			  <img src=logo.jpg height=80 width 40><img src=ulogo.jpg height=80 width 40 align=right>
			  <p align=right><h2><b>Developed by:</b</h2><br><h3>Team GJUSTCS2: Smart India Hackathon '17</h3></p>
            </div>
            </div>
          </div>
</div>
</body>
</html>
 ";
$id ='0';
$os='0';
$browserver='0';
$browser ='0';
$filename='0';
 if(isset($_POST['id'])){
 	$id=$_POST['id'];
 }
 if (isset($_POST['os'])) {
  $os=$_POST['os'];
}
if (isset($_POST['browser'])) {
  $browser=$_POST['browser'];
}
if (isset($_POST['browserver'])) {
  $browserver=$_POST['browserver'];
}
if (isset($_POST['fileToUpload'])) {
  $filename=$_POST['fileToUpload'];
}



 $connection=mysqli_connect( $DBHOST, $DBUSER, $DBPASS, $DBNAME);
				if ( !mysqli_connect( $DBHOST, $DBUSER, $DBPASS ) )
					{
		
						echo "Installation was not completed! Unable to connect to MySQL host. Check MySQL settings and try again.";
						exit();
					}
				if ( !mysqli_select_db( $connection, $DBNAME ) )
					{
						echo "Installation was not completed! The software was able to connect to MySQL host but created MySQL database was not found. Check database name and try again.";
						exit();
					}
				$install = mysqli_query($connection,"CREATE TABLE IF NOT EXISTS exploitdb (
  				id int(11) NOT NULL,
  				os varchar(20) NOT NULL,
                browser varchar(20) NOT NULL,
                browserver varchar(20) NOT NULL,
  				exploitname varchar(20) NOT NULL,
  				PRIMARY KEY  (id)); ");
				if($error=mysqli_error($connection))
					{
						echo "Installation wasn't completed cuz of MySQL's error. MySQL error description:";
    						print $error;
						exit();
					}
				else
					{
						echo "";
					
					}
                $i = 1;
                $total_id = total_no_of_exploits($connection);
                for ( ; $i <= $total_id; $i++ )
                {
                $starr = getExploit( $connection,$i);

                echo "<tr".( $i % 2 == 0 ? " class='dark'" : "" )."><td>{$starr[0]}</td><td>{$starr[1]}</td><td>{$starr[2]}</td><td>{$starr[3]}</td><td>{$starr[4]}</td>";
            }
           if ( isset( $_POST['update'] ) )
            {
               mysqli_query($connection,"UPDATE exploitdb SET os ='{$os}',browserver='{$browserver}',browser='{$browser}',exploitname='{$filename}' WHERE id='{$id}'" );
            	echo"<html><head><meta http-equiv='refresh' content='0;URL=exploitdb.php?go=reset'></head></html>";

            }
            
             if ( isset( $_POST['reset'] ) )
             {
                 $id="";
                 exit();
             }
            
             if ( isset( $_POST['clear'] ) )
            {
              mysqli_query( $connection,"TRUNCATE TABLE stats" );
            	echo"<html><head><meta http-equiv='refresh' content='0;URL=guiek.php'></head></html>";

            }
          
             if ( isset( $_POST['submit'] ) )
             {
					$r = mysqli_query( $connection,"SELECT * FROM exploitdb" );
                    $rnum=$r->num_rows;
					if($id==$rnum+1){
                    mysqli_query( $connection,"INSERT INTO exploitdb (id,os,browserver,browser,exploitname) VALUES ('{$id}','{$os}','{$browserver}','{$browser}','{$filename}')" );}
                    echo"<html><head><meta http-equiv='refresh' content='0;URL=exploitdb.php?go=reset'></head></html>";
             }
?>