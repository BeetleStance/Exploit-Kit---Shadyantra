<?php

require_once("databasedetails.php");
require_once("otherfunctions.php");
$connection=mysqli_connect( $DBHOST, $DBUSER, $DBPASS, $DBNAME ) ;
$year = date("y");
$month = date("m");
$day = date("d");
$i=0;
$todaydate = date("y-m-d");
$r=mysqli_query($connection,"SELECT today_date,no_of_visitors FROM analytics");
$rows=[];
while($row=mysqli_fetch_row($r))
{
        $rows[]=$row;
}


$hit = mysqli_query($connection,"SELECT no_of_hits AS hits FROM analytics WHERE today_date = '{$todaydate}'");
$hitsrow = mysqli_fetch_assoc($hit);
$total_hits = $hitsrow['hits'];

echo $total_hits;


        $total = mysqli_query($connection," SELECT SUM(no_of_visitors) AS total_sum FROM analytics");
        $visits = mysqli_fetch_assoc($total);
        $total_visits = $visits['total_sum'];
  $total_id = total_no_of_visits($connection);
echo "<!DOCTYPE html>
<!-- saved from url=(0043)http://getbootstrap.com/examples/dashboard/ --><html lang='en'><head><meta http-equiv='Content-Type' content='text/html; charset=UTF-8'><meta http-equiv='X-UA-Compatible' content='IE=edge'><meta name='viewport' content='width=device-width, initial-scale=1'><!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags --><meta name='description' content=''><meta name='author' content=''>
<link rel='icon' href='./Dashboard Template for Bootstrap_files/security.png'>
<title>Exploit kit</title>
    <!-- Bootstrap core CSS -->
    <link href='./Dashboard Template for Bootstrap_files/bootstrap.min.css' rel='stylesheet'>

    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <link href='./Dashboard Template for Bootstrap_files/ie10-viewport-bug-workaround.css' rel='stylesheet'>
  <link rel='stylesheet' type='text/css' href='analytics.css's>
    <!-- Custom styles for this template -->
    <link href='./Dashboard Template for Bootstrap_files/dashboard.css' rel='stylesheet'>

    <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
    <!--[if lt IE 9]><script src='../../assets/js/ie8-responsive-file-warning.js'></script><![endif]-->
    <script src='./Dashboard Template for Bootstrap_files/ie-emulation-modes-warning.js.download'></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src='https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js'></script>
      <script src='https://oss.maxcdn.com/respond/1.4.2/respond.min.js'></script>
    <![endif]-->
<meta http-equiv='Content-Type' content='text/html; charset=utf-8'>
        
</head>

  <body>

    <nav class='navbar navbar-inverse navbar-fixed-top'>
      <div class='container-fluid'>
        <div class='navbar-header'>
          <button type='button' class='navbar-toggle collapsed' data-toggle='collapse' data-target='#navbar' aria-expanded='false' aria-controls='navbar'>
            <span class='sr-only'>Toggle navigation</span>
            <span class='icon-bar'></span>
            <span class='icon-bar'></span>
            <span class='icon-bar'></span>
          </button>
 <a class='navbar-brand' href='#openModal'>Exploit Kit</a>
 </div>
        <div id='navbar' class='navbar-collapse collapse'>
          <ul class='nav navbar-nav navbar-right'>
            

            <div class='dropdown'>
  <button class='dropbtn' >Clear Statistics</button>
  <div class='dropdown-content'>
    <form method='POST' id='clearform'><input type='hidden' name='clear' value='Yes'><a href='#' class='red' onclick='javascript:document.getElementById(\"clearform\").submit();'>Yes</a><a class='red' href='guiek.php'>No</a></form>

  </div>
</div>
            <li><a href='install.php?go=instoall'>Settings</a></li>
            <li><a href='guiek.php?go=logout'>Logout</a></li>
          </ul>
          
        </div>
      </div>
    </nav>
    
    <div class='container-fluid'>
      <div class='row'>
        <div class='col-sm-3 col-md-2 sidebar'>
          <ul class='nav nav-sidebar'>
            <li><a href='guiek.php'>Dashboard</a></li>
            <li><a href='guiek.php?go=report'>Reports<span class='sr-only'>(current)</span></a></li>
            <li class='active'><a href='analytics.php'>Analytics</a></li>
            <li><a href='exploitdb.php'>Import</a></li>
          </ul>
          
          <ul class='nav nav-sidebar'>
            
            <li><a href='exploitselector.php' target='_blank'>Demo</a></li>
            <li><a href='guiek.php?go=about'>About</a></li>
          </ul>
          <br><br><br><br><br><br><br><br><h5 style='font-family: tahoma;color:#428bca'>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp CODE NAME</h5>
          <h4> &nbsp&nbsp&nbsp&nbsp SHADAYANTRA</h4>
        </div>
        <div class='col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main'>
          <h1 class='page-header'>Analytical Details</h1>
          <div class='table-responsive'>
            <table class='table table-striped'>
              <thead>
                <tr>
                  <th>ID</th>
                  <th>DATE</th>
                  <th>VISITS</th>
                  <th>HITS</th>
                </tr>
              </thead>
           <div id='openModal' class='modalDialog'>
            <div>
              <div>
              <a href='#close' title='close' class='close'>X</a>
              <h1>Exploit Kit-Shadyantra</h1>
			  <img src=logo.jpg height=80 width 40><img src=ulogo.jpg height=80 width 40 align=right>
			  <p align=right><h2><b>Developed by:</b</h2><br><h3>Team GJUSTCS2: Smart India Hackathon '17</h3></p>
            </div>
            </div>
          </div>";
        $i = 1;
      
            for ( ; $i <= $total_id; $i++ )
        {
              $starr = getAnalytics( $connection,$i );
              echo "<tr".( $i % 2 == 0 ? " class='dark'" : "" )."><td>{$starr[0]}</td><td>{$starr[1]}</td><td>{$starr[2]}</td><td>{$starr[3]}</td>";
            }

    if ( isset( $_POST['clear'] ) )
            {
              mysqli_query( $connection,"TRUNCATE TABLE stats" );
            	echo"<html><head><meta http-equiv='refresh' content='0;URL=guiek.php?go='></head></html>";
            }       
?>